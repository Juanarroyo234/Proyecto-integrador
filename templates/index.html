<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Predicción de Partidos - Estilo Casino</title>
    <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
    <div class="container">
        <h1>Predicción de Partidos de Fútbol</h1>

        <div class="form-group">
            <label for="equipo_local">Equipo Local:</label>
            <select id="equipo_local"></select>
        </div>

        <div class="form-group">
            <label for="equipo_visitante">Equipo Visitante:</label>
            <select id="equipo_visitante"></select>
        </div>

        <button onclick="hacerPrediccion()">Predecir Resultado</button>

        <div id="resultado" class="resultado"></div>
    </div>

    <script>
    async function cargarEquipos() {
        try {
            const res = await fetch('/equipos');
            const data = await res.json();
            const equipos = data.equipos;

            const localSelect = document.getElementById('equipo_local');
            const visitaSelect = document.getElementById('equipo_visitante');

            localSelect.innerHTML = "";
            visitaSelect.innerHTML = "";

            equipos.forEach(equipo => {
                const optionLocal = document.createElement('option');
                optionLocal.value = equipo;
                optionLocal.text = equipo;
                localSelect.appendChild(optionLocal);

                const optionVisita = document.createElement('option');
                optionVisita.value = equipo;
                optionVisita.text = equipo;
                visitaSelect.appendChild(optionVisita);
            });
        } catch (error) {
            console.error("Error al cargar equipos:", error);
        }
    }

    async function hacerPrediccion() {
        const equipo_local = document.getElementById('equipo_local').value;
        const equipo_visitante = document.getElementById('equipo_visitante').value;

        const resultadoDiv = document.getElementById('resultado');
        resultadoDiv.textContent = "Cargando predicción...";

        try {
            const res = await fetch(`/predecir/?equipo_local=${encodeURIComponent(equipo_local)}&equipo_visitante=${encodeURIComponent(equipo_visitante)}`);
            const data = await res.json();

            if(data.error){
                resultadoDiv.textContent = data.error;
            } else {
                resultadoDiv.textContent = `Predicción: ${data.prediccion} para el partido ${data.equipo_local} vs ${data.equipo_visitante}`;
            }
        } catch (error) {
            resultadoDiv.textContent = "Error al obtener la predicción.";
            console.error(error);
        }
    }

    window.onload = cargarEquipos;
    </script>
</body>
</html>
